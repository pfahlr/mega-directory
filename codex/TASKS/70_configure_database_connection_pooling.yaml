id: 70
filename: 70_configure_database_connection_pooling.yaml
title: Configure Database Connection Pooling
description: >
  Optimize database connection pool settings for better performance and
  resource utilization.

  Implementation:
  - Configure Prisma connection pool settings
  - Set appropriate connection limits
  - Configure pool timeout
  - Document connection pool behavior
  - Monitor connection pool usage

  Configuration:
  # In .env
  DATABASE_URL="postgresql://user:pass@localhost:5432/db?connection_limit=20&pool_timeout=10"

  # db/schema.prisma
  datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
  }

  # .env.example
  # Connection pool settings:
  # - connection_limit: max connections (default: num_cpus * 2 + 1)
  # - pool_timeout: seconds to wait for connection (default: 10)
  DATABASE_URL="postgresql://postgres:password@localhost:5432/mega_directory?connection_limit=20&pool_timeout=10&connect_timeout=10"

  Recommendations:
  - Development: connection_limit=10
  - Production: connection_limit=20-50 (depends on load)
  - Monitor with: SELECT count(*) FROM pg_stat_activity;

dependencies: []
